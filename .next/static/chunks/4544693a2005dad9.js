(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,60389,e=>{"use strict";e.s(["default",()=>a]);var t=e.i(3126),r=e.i(21924);let o=["wishlist","reading","completed"];function a(){let[e,a]=(0,r.useState)([]),[s,i]=(0,r.useState)(!0),[n,l]=(0,r.useState)(""),[d,c]=(0,r.useState)("all"),[u,p]=(0,r.useState)(""),[h,x]=(0,r.useState)(""),[g,b]=(0,r.useState)("wishlist"),[f,y]=(0,r.useState)(!1),[m,k]=(0,r.useState)(null),[v,j]=(0,r.useState)(null),w=(0,r.useRef)(null),[S,C]=(0,r.useState)(()=>{try{var e;return null!=(e=localStorage.getItem("booktracker_theme"))?e:"dark"}catch(e){return"dark"}}),E={wishlist:{bg:"#38bdf8",text:"#021422"},reading:{bg:"#f59e0b",text:"#031527"},completed:{bg:"#10b981",text:"#031527"},unknown:{bg:"#64748b",text:"#031527"}},R=async()=>{i(!0),k(null);try{let e=await fetch("/api/books");if(!e.ok){let t=await e.text();throw console.error("GET /api/books error",e.status,t),Error(t||"Server ".concat(e.status))}let t=await e.json();a(Array.isArray(t)?t:[])}catch(e){console.error("Fetch books error",e),k("Failed to load books (see console).")}finally{i(!1)}};(0,r.useEffect)(()=>{function e(e){w.current&&(w.current.contains(e.target)||j(null))}return R(),document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[]),(0,r.useEffect)(()=>{try{localStorage.setItem("booktracker_theme",S)}catch(e){}},[S]);let T=async e=>{null==e||e.preventDefault(),k(null);let t=u.trim();if(!t)return void k("Title required");y(!0);try{let e=await fetch("/api/books",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:t,author:h.trim()||null,status:g})});if(!e.ok){let t=await e.text();throw console.error("POST /api/books error",e.status,t),Error(t||"Server ".concat(e.status))}p(""),x(""),b("wishlist"),await R()}catch(e){console.error("Add error",e),k("Failed to add book (see console).")}finally{y(!1)}},A=async(e,t)=>{a(r=>r.map(r=>r.id===e?{...r,status:t}:r)),j(null);try{let r=await fetch("/api/books/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})});if(!r.ok){let e=await r.text();throw console.error("PATCH failed",r.status,e),Error(e||"Server ".concat(r.status))}let o=await r.json().catch(()=>null);o&&o.id&&a(t=>t.map(t=>t.id===e?o:t))}catch(e){console.error("Failed to update status:",e),k("Failed to update status (unauthorized or invalid key)."),"string"==typeof(null==e?void 0:e.message)&&e.message.toLowerCase().includes("unauthorized")&&alert('Server returned "Unauthorized". Ensure SUPABASE_SERVICE_ROLE_KEY is set in .env.local and restart Next.'),R()}},I=async e=>{if(confirm("Delete this book?"))try{let t=await fetch("/api/books/".concat(e),{method:"DELETE"});if(!t.ok){let e=await t.text();throw console.error("DELETE /api/books/:id failed",t.status,e),Error(e||"Server ".concat(t.status))}a(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Delete failed",e),k("Delete failed (see console)."),R()}},z=e.filter(e=>"all"===d||e.status===d).filter(e=>{var t,r;if(!n.trim())return!0;let o=n.toLowerCase();return(null!=(t=e.title)?t:"").toLowerCase().includes(o)||(null!=(r=e.author)?r:"").toLowerCase().includes(o)}),L="dark"===S,W=L?"#e6eef7":"#08203a",D=L?"#9aa7b6":"#6b7280",P={padding:"10px 12px",borderRadius:8,border:"1px solid ".concat(L?"rgba(255,255,255,0.04)":"#dbeafe"),background:L?"#082034":"#fff",color:W,outline:"none",fontSize:14},_={...P,appearance:"none"},O={...P,flex:1,transition:"box-shadow 180ms ease"},B={...P,width:320,transition:"box-shadow 180ms ease"},U={padding:"10px 14px",borderRadius:999,border:"none",background:E[g].bg,color:E[g].text,fontWeight:800,cursor:"pointer",transition:"transform 160ms ease"},F={display:"flex",justifyContent:"space-between",alignItems:"center",background:L?"#071827":"#ffffff",padding:"14px 18px",borderRadius:10,border:"1px solid ".concat(L?"rgba(255,255,255,0.03)":"#e6eef7"),transition:"transform 160ms ease, box-shadow 160ms ease"},Y={maxWidth:"68%"},N={fontWeight:800,fontSize:18,marginBottom:6},H={color:D,fontStyle:"italic"},K={position:"absolute",right:0,marginTop:8,background:L?"#06202e":"#ffffff",border:"1px solid ".concat(L?"rgba(255,255,255,0.04)":"#e6eef7"),borderRadius:8,overflow:"hidden",minWidth:160,zIndex:80,boxShadow:L?"0 8px 30px rgba(2,6,23,0.6)":"0 8px 30px rgba(2,6,23,0.06)"},q={padding:"8px 12px",borderRadius:8,border:"none",background:"#2563eb",color:"#fff",cursor:"pointer",fontWeight:700};return(0,t.jsx)("div",{style:{minHeight:"100vh",background:L?"#05070a":"#f6f8fb",color:W,fontFamily:'Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial',padding:16,boxSizing:"border-box",transition:"background 220ms ease, color 220ms ease"},children:(0,t.jsxs)("div",{style:{maxWidth:1100,margin:"6px auto"},ref:w,children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:12},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{style:{margin:"6px 0 4px 0"},children:"Your Books"}),(0,t.jsx)("div",{style:{color:D,fontSize:13},children:"Compact dashboard with theme toggle and animated controls."})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,t.jsx)("button",{onClick:()=>C(e=>"dark"===e?"light":"dark"),style:{padding:"8px 10px",borderRadius:8,border:"1px solid rgba(255,255,255,0.06)",background:"transparent",color:W,cursor:"pointer"},children:"dark"===S?"Switch to Light":"Switch to Dark"}),(0,t.jsx)("button",{onClick:R,style:{padding:"8px 10px",borderRadius:8,border:"1px solid rgba(255,255,255,0.06)",background:"transparent",color:W,cursor:"pointer"},children:"Refresh"})]})]}),(0,t.jsxs)("div",{style:{marginTop:12,display:"flex",gap:8,alignItems:"center"},children:[(0,t.jsx)("input",{placeholder:"Search by title or author",value:n,onChange:e=>l(e.target.value),style:{...P,flex:1}}),(0,t.jsxs)("select",{value:d,onChange:e=>c(e.target.value),style:{..._},children:[(0,t.jsx)("option",{value:"all",children:"All statuses"}),(0,t.jsx)("option",{value:"wishlist",children:"Wishlist"}),(0,t.jsx)("option",{value:"reading",children:"Reading"}),(0,t.jsx)("option",{value:"completed",children:"Completed"})]}),(0,t.jsx)("button",{onClick:()=>{l(""),c("all")},style:{padding:"10px 12px",borderRadius:8,border:"1px solid rgba(255,255,255,0.06)",background:"transparent",color:W,cursor:"pointer"},children:"Clear"})]}),(0,t.jsxs)("form",{onSubmit:T,style:{display:"flex",gap:8,alignItems:"center",marginBottom:10},children:[(0,t.jsx)("input",{placeholder:"Title (required)",value:u,onChange:e=>p(e.target.value),style:O}),(0,t.jsx)("input",{placeholder:"Author (optional)",value:h,onChange:e=>x(e.target.value),style:B}),(0,t.jsxs)("select",{value:g,onChange:e=>b(e.target.value),style:U,children:[(0,t.jsx)("option",{value:"wishlist",children:"Wishlist"}),(0,t.jsx)("option",{value:"reading",children:"Reading"}),(0,t.jsx)("option",{value:"completed",children:"Completed"})]}),(0,t.jsx)("button",{type:"button",onClick:()=>{p(""),x(""),b("wishlist"),k(null)},style:{padding:"10px 12px",borderRadius:8,border:"1px solid rgba(255,255,255,0.06)",background:"transparent",color:W,cursor:"pointer"},children:"Clear"}),(0,t.jsx)("button",{type:"submit",disabled:f,style:{padding:"10px 14px",borderRadius:8,border:"none",background:"#60a5fa",color:"#07203a",fontWeight:800,cursor:"pointer",transform:"translateY(0)",transition:"transform 140ms ease, box-shadow 160ms ease",transform:f?"translateY(0)":"translateY(-2px)",boxShadow:f?"none":"0 8px 20px rgba(96,165,250,0.14)"},onMouseDown:()=>{},children:f?"Adding…":"Add"})]}),m&&(0,t.jsx)("div",{style:{color:"#ff8080",marginTop:6},children:m}),(0,t.jsx)("div",{style:{display:"grid",gap:12,marginTop:6},children:s?(0,t.jsx)("div",{style:{color:D},children:"Loading…"}):z.length?z.map(e=>{var r,a,s;let i,n,l=null!=(r=e.status)?r:"wishlist",d=null!=(a=E[l])?a:E.unknown,c=v===e.id;return(0,t.jsxs)("div",{style:{...F,position:"relative"},children:[(0,t.jsxs)("div",{style:Y,children:[(0,t.jsx)("div",{style:N,children:e.title}),(0,t.jsxs)("div",{style:H,children:[e.author&&"".concat(e.author," • ")||"",(0,t.jsx)("span",{style:{textTransform:"capitalize"},children:null!=(s=e.status)?s:"—"})]})]}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,t.jsxs)("div",{onClick:t=>{t.stopPropagation(),j(c?null:e.id)},style:(i=d.bg,n=d.text,{display:"inline-flex",alignItems:"center",gap:10,padding:"10px 16px",borderRadius:999,border:"2px solid ".concat(L?"rgba(255,255,255,0.12)":"#cfe8ff"),background:i,color:n,fontWeight:800,cursor:"pointer",boxShadow:L?"0 6px 18px rgba(2,6,23,0.6)":"0 4px 12px rgba(2,6,23,0.06)",transition:"transform 140ms ease, box-shadow 160ms ease"}),children:[(0,t.jsx)("span",{style:{width:10,height:10,borderRadius:999,background:"#ffffff55",display:"inline-block"}}),(0,t.jsx)("span",{style:{textTransform:"capitalize"},children:l})]}),c&&(0,t.jsx)("div",{style:K,onClick:e=>e.stopPropagation(),children:o.map(r=>{let o=E[r],a=r===l?L?"#0b2b3a":"#f1f5f9":L?"#06202e":"#fff",s=r===l?o.text:L?"#e6eef7":"#08203a";return(0,t.jsxs)("div",{role:"button",onClick:()=>A(e.id,r),style:{display:"flex",alignItems:"center",gap:10,padding:"10px 12px",cursor:"pointer",background:a,color:s,fontWeight:800,transition:"background 140ms ease"},children:[(0,t.jsx)("span",{style:{width:10,height:10,borderRadius:999,background:o.bg,display:"inline-block"}}),(0,t.jsx)("span",{style:{textTransform:"capitalize"},children:r})]},r)})}),(0,t.jsx)("button",{onClick:()=>I(e.id),style:q,children:"Delete"}),(0,t.jsx)("div",{style:{color:D,fontSize:12},children:e.created_at?new Date(e.created_at).toLocaleString():""})]})]},e.id)}):(0,t.jsx)("div",{style:{color:D},children:"No books yet — add one above."})}),(0,t.jsxs)("div",{style:{marginTop:12,color:D,fontSize:13},children:['Tip: click a colored pill to open the menu. If you see "Unauthorized" in console, make sure `SUPABASE_SERVICE_ROLE_KEY` is set in ',(0,t.jsx)("code",{children:".env.local"}),"."]})]})})}}]);