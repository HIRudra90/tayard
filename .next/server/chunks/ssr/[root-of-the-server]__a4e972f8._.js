module.exports=[18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},88903,(a,b,c)=>{"use strict";b.exports=a.r(18622)},53377,(a,b,c)=>{"use strict";b.exports=a.r(88903).vendored["react-ssr"].ReactJsxRuntime},21801,(a,b,c)=>{"use strict";b.exports=a.r(88903).vendored["react-ssr"].React},14524,a=>{"use strict";a.s(["default",()=>e]);var b=a.i(53377),c=a.i(21801);let d=["wishlist","reading","completed"];function e(){let[a,e]=(0,c.useState)([]),[f,g]=(0,c.useState)(!0),[h,i]=(0,c.useState)(""),[j,k]=(0,c.useState)("all"),[l,m]=(0,c.useState)(""),[n,o]=(0,c.useState)(""),[p,q]=(0,c.useState)("wishlist"),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)(null),[v,w]=(0,c.useState)(null),x=(0,c.useRef)(null),[y,z]=(0,c.useState)(()=>{try{return localStorage.getItem("booktracker_theme")??"dark"}catch{return"dark"}}),A={wishlist:{bg:"#38bdf8",text:"#021422"},reading:{bg:"#f59e0b",text:"#031527"},completed:{bg:"#10b981",text:"#031527"},unknown:{bg:"#64748b",text:"#031527"}},B=async()=>{g(!0),u(null);try{let a=await fetch("/api/books");if(!a.ok){let b=await a.text();throw console.error("GET /api/books error",a.status,b),Error(b||`Server ${a.status}`)}let b=await a.json();e(Array.isArray(b)?b:[])}catch(a){console.error("Fetch books error",a),u("Failed to load books (see console).")}finally{g(!1)}};(0,c.useEffect)(()=>{function a(a){x.current&&(x.current.contains(a.target)||w(null))}return B(),document.addEventListener("click",a),()=>document.removeEventListener("click",a)},[]),(0,c.useEffect)(()=>{try{localStorage.setItem("booktracker_theme",y)}catch{}},[y]);let C=async a=>{a?.preventDefault(),u(null);let b=l.trim();if(!b)return void u("Title required");s(!0);try{let a=await fetch("/api/books",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:b,author:n.trim()||null,status:p})});if(!a.ok){let b=await a.text();throw console.error("POST /api/books error",a.status,b),Error(b||`Server ${a.status}`)}m(""),o(""),q("wishlist"),await B()}catch(a){console.error("Add error",a),u("Failed to add book (see console).")}finally{s(!1)}},D=async(a,b)=>{e(c=>c.map(c=>c.id===a?{...c,status:b}:c)),w(null);try{let c=await fetch(`/api/books/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:b})});if(!c.ok){let a=await c.text();throw console.error("PATCH failed",c.status,a),Error(a||`Server ${c.status}`)}let d=await c.json().catch(()=>null);d&&d.id&&e(b=>b.map(b=>b.id===a?d:b))}catch(a){console.error("Failed to update status:",a),u("Failed to update status (unauthorized or invalid key)."),"string"==typeof a?.message&&a.message.toLowerCase().includes("unauthorized")&&alert('Server returned "Unauthorized". Ensure SUPABASE_SERVICE_ROLE_KEY is set in .env.local and restart Next.'),B()}},E=async a=>{if(confirm("Delete this book?"))try{let b=await fetch(`/api/books/${a}`,{method:"DELETE"});if(!b.ok){let a=await b.text();throw console.error("DELETE /api/books/:id failed",b.status,a),Error(a||`Server ${b.status}`)}e(b=>b.filter(b=>b.id!==a))}catch(a){console.error("Delete failed",a),u("Delete failed (see console)."),B()}},F=a.filter(a=>"all"===j||a.status===j).filter(a=>{if(!h.trim())return!0;let b=h.toLowerCase();return(a.title??"").toLowerCase().includes(b)||(a.author??"").toLowerCase().includes(b)}),G="dark"===y,H=G?"#e6eef7":"#08203a",I=G?"#9aa7b6":"#6b7280",J={padding:"10px 12px",borderRadius:8,border:`1px solid ${G?"rgba(255,255,255,0.04)":"#dbeafe"}`,background:G?"#082034":"#fff",color:H,outline:"none",fontSize:14},K={...J,appearance:"none"},L={...J,flex:1,transition:"box-shadow 180ms ease"},M={...J,width:320,transition:"box-shadow 180ms ease"},N={padding:"10px 14px",borderRadius:999,border:"none",background:A[p].bg,color:A[p].text,fontWeight:800,cursor:"pointer",transition:"transform 160ms ease"},O={display:"flex",justifyContent:"space-between",alignItems:"center",background:G?"#071827":"#ffffff",padding:"14px 18px",borderRadius:10,border:`1px solid ${G?"rgba(255,255,255,0.03)":"#e6eef7"}`,transition:"transform 160ms ease, box-shadow 160ms ease"},P={maxWidth:"68%"},Q={fontWeight:800,fontSize:18,marginBottom:6},R={color:I,fontStyle:"italic"},S={position:"absolute",right:0,marginTop:8,background:G?"#06202e":"#ffffff",border:`1px solid ${G?"rgba(255,255,255,0.04)":"#e6eef7"}`,borderRadius:8,overflow:"hidden",minWidth:160,zIndex:80,boxShadow:G?"0 8px 30px rgba(2,6,23,0.6)":"0 8px 30px rgba(2,6,23,0.06)"},T={padding:"8px 12px",borderRadius:8,border:"none",background:"#2563eb",color:"#fff",cursor:"pointer",fontWeight:700};return(0,b.jsx)("div",{style:{minHeight:"100vh",background:G?"#05070a":"#f6f8fb",color:H,fontFamily:'Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial',padding:16,boxSizing:"border-box",transition:"background 220ms ease, color 220ms ease"},children:(0,b.jsxs)("div",{style:{maxWidth:1100,margin:"6px auto"},ref:x,children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:12},children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{style:{margin:"6px 0 4px 0"},children:"Your Books"}),(0,b.jsx)("div",{style:{color:I,fontSize:13},children:"Compact dashboard with theme toggle and animated controls."})]}),(0,b.jsxs)("div",{style:{display:"flex",gap:8},children:[(0,b.jsx)("button",{onClick:()=>z(a=>"dark"===a?"light":"dark"),style:{padding:"8px 10px",borderRadius:8,border:"1px solid rgba(255,255,255,0.06)",background:"transparent",color:H,cursor:"pointer"},children:"dark"===y?"Switch to Light":"Switch to Dark"}),(0,b.jsx)("button",{onClick:B,style:{padding:"8px 10px",borderRadius:8,border:"1px solid rgba(255,255,255,0.06)",background:"transparent",color:H,cursor:"pointer"},children:"Refresh"})]})]}),(0,b.jsxs)("div",{style:{marginTop:12,display:"flex",gap:8,alignItems:"center"},children:[(0,b.jsx)("input",{placeholder:"Search by title or author",value:h,onChange:a=>i(a.target.value),style:{...J,flex:1}}),(0,b.jsxs)("select",{value:j,onChange:a=>k(a.target.value),style:{...K},children:[(0,b.jsx)("option",{value:"all",children:"All statuses"}),(0,b.jsx)("option",{value:"wishlist",children:"Wishlist"}),(0,b.jsx)("option",{value:"reading",children:"Reading"}),(0,b.jsx)("option",{value:"completed",children:"Completed"})]}),(0,b.jsx)("button",{onClick:()=>{i(""),k("all")},style:{padding:"10px 12px",borderRadius:8,border:"1px solid rgba(255,255,255,0.06)",background:"transparent",color:H,cursor:"pointer"},children:"Clear"})]}),(0,b.jsxs)("form",{onSubmit:C,style:{display:"flex",gap:8,alignItems:"center",marginBottom:10},children:[(0,b.jsx)("input",{placeholder:"Title (required)",value:l,onChange:a=>m(a.target.value),style:L}),(0,b.jsx)("input",{placeholder:"Author (optional)",value:n,onChange:a=>o(a.target.value),style:M}),(0,b.jsxs)("select",{value:p,onChange:a=>q(a.target.value),style:N,children:[(0,b.jsx)("option",{value:"wishlist",children:"Wishlist"}),(0,b.jsx)("option",{value:"reading",children:"Reading"}),(0,b.jsx)("option",{value:"completed",children:"Completed"})]}),(0,b.jsx)("button",{type:"button",onClick:()=>{m(""),o(""),q("wishlist"),u(null)},style:{padding:"10px 12px",borderRadius:8,border:"1px solid rgba(255,255,255,0.06)",background:"transparent",color:H,cursor:"pointer"},children:"Clear"}),(0,b.jsx)("button",{type:"submit",disabled:r,style:{padding:"10px 14px",borderRadius:8,border:"none",background:"#60a5fa",color:"#07203a",fontWeight:800,cursor:"pointer",transform:"translateY(0)",transition:"transform 140ms ease, box-shadow 160ms ease",transform:r?"translateY(0)":"translateY(-2px)",boxShadow:r?"none":"0 8px 20px rgba(96,165,250,0.14)"},onMouseDown:()=>{},children:r?"Adding…":"Add"})]}),t&&(0,b.jsx)("div",{style:{color:"#ff8080",marginTop:6},children:t}),(0,b.jsx)("div",{style:{display:"grid",gap:12,marginTop:6},children:f?(0,b.jsx)("div",{style:{color:I},children:"Loading…"}):F.length?F.map(a=>{let c=a.status??"wishlist",e=A[c]??A.unknown,f=v===a.id;return(0,b.jsxs)("div",{style:{...O,position:"relative"},children:[(0,b.jsxs)("div",{style:P,children:[(0,b.jsx)("div",{style:Q,children:a.title}),(0,b.jsxs)("div",{style:R,children:[a.author&&`${a.author} • `||"",(0,b.jsx)("span",{style:{textTransform:"capitalize"},children:a.status??"—"})]})]}),(0,b.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:10},children:[(0,b.jsxs)("div",{onClick:b=>{b.stopPropagation(),w(f?null:a.id)},style:{display:"inline-flex",alignItems:"center",gap:10,padding:"10px 16px",borderRadius:999,border:`2px solid ${G?"rgba(255,255,255,0.12)":"#cfe8ff"}`,background:e.bg,color:e.text,fontWeight:800,cursor:"pointer",boxShadow:G?"0 6px 18px rgba(2,6,23,0.6)":"0 4px 12px rgba(2,6,23,0.06)",transition:"transform 140ms ease, box-shadow 160ms ease"},children:[(0,b.jsx)("span",{style:{width:10,height:10,borderRadius:999,background:"#ffffff55",display:"inline-block"}}),(0,b.jsx)("span",{style:{textTransform:"capitalize"},children:c})]}),f&&(0,b.jsx)("div",{style:S,onClick:a=>a.stopPropagation(),children:d.map(d=>{let e=A[d],f=d===c?G?"#0b2b3a":"#f1f5f9":G?"#06202e":"#fff",g=d===c?e.text:G?"#e6eef7":"#08203a";return(0,b.jsxs)("div",{role:"button",onClick:()=>D(a.id,d),style:{display:"flex",alignItems:"center",gap:10,padding:"10px 12px",cursor:"pointer",background:f,color:g,fontWeight:800,transition:"background 140ms ease"},children:[(0,b.jsx)("span",{style:{width:10,height:10,borderRadius:999,background:e.bg,display:"inline-block"}}),(0,b.jsx)("span",{style:{textTransform:"capitalize"},children:d})]},d)})}),(0,b.jsx)("button",{onClick:()=>E(a.id),style:T,children:"Delete"}),(0,b.jsx)("div",{style:{color:I,fontSize:12},children:a.created_at?new Date(a.created_at).toLocaleString():""})]})]},a.id)}):(0,b.jsx)("div",{style:{color:I},children:"No books yet — add one above."})}),(0,b.jsxs)("div",{style:{marginTop:12,color:I,fontSize:13},children:['Tip: click a colored pill to open the menu. If you see "Unauthorized" in console, make sure `SUPABASE_SERVICE_ROLE_KEY` is set in ',(0,b.jsx)("code",{children:".env.local"}),"."]})]})})}}];

//# sourceMappingURL=%5Broot-of-the-server%5D__a4e972f8._.js.map