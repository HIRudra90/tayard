{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 91, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Hasidul%20Islam/Desktop/Book%20Tracking/book-tracker/src/app/api/books/%5Bid%5D/route.ts"],"sourcesContent":["// src/app/api/books/[id]/route.ts\r\nimport { NextResponse } from 'next/server';\r\nimport { createClient } from '@supabase/supabase-js';\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\r\nconst serviceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\r\n\r\nif (!supabaseUrl || !serviceRoleKey) {\r\n  console.error('Missing SUPABASE env vars on server. Ensure NEXT_PUBLIC_SUPABASE_URL and SUPABASE_SERVICE_ROLE_KEY are set.');\r\n}\r\n\r\nconst serverSupabase = supabaseUrl && serviceRoleKey\r\n  ? createClient(supabaseUrl, serviceRoleKey)\r\n  : null;\r\n\r\nexport async function PATCH(req: Request, { params }: { params: { id: string } }) {\r\n  const id = params.id;\r\n  if (!serverSupabase) {\r\n    return NextResponse.json({ error: 'Server configuration error: missing Supabase keys' }, { status: 500 });\r\n  }\r\n  try {\r\n    const body = await req.json();\r\n    if (!body || Object.keys(body).length === 0) {\r\n      return NextResponse.json({ error: 'No update payload provided' }, { status: 400 });\r\n    }\r\n\r\n    // allow only certain fields\r\n    const allowed: Record<string, any> = {};\r\n    if (body.status) allowed.status = body.status;\r\n    if (body.title) allowed.title = body.title;\r\n    if ('author' in body) allowed.author = body.author;\r\n\r\n    if (Object.keys(allowed).length === 0) {\r\n      return NextResponse.json({ error: 'No valid fields to update' }, { status: 400 });\r\n    }\r\n\r\n    const { data, error, status } = await serverSupabase\r\n      .from('books')\r\n      .update(allowed)\r\n      .eq('id', id)\r\n      .select()\r\n      .single();\r\n\r\n    if (error) {\r\n      console.error(`Supabase PATCH /books/${id} error`, error);\r\n      return NextResponse.json({ error: error.message || 'Supabase update error' }, { status: status ?? 500 });\r\n    }\r\n\r\n    return NextResponse.json(data, { status: 200 });\r\n  } catch (err: any) {\r\n    console.error(`Unexpected PATCH /api/books/${id} error`, err);\r\n    return NextResponse.json({ error: String(err) }, { status: 500 });\r\n  }\r\n}\r\n\r\nexport async function DELETE(_req: Request, { params }: { params: { id: string } }) {\r\n  const id = params.id;\r\n  if (!serverSupabase) {\r\n    return NextResponse.json({ error: 'Server configuration error: missing Supabase keys' }, { status: 500 });\r\n  }\r\n  try {\r\n    const { data, error, status } = await serverSupabase.from('books').delete().eq('id', id);\r\n\r\n    if (error) {\r\n      console.error(`Supabase DELETE /books/${id} error`, error);\r\n      return NextResponse.json({ error: error.message || 'Supabase delete error' }, { status: status ?? 500 });\r\n    }\r\n\r\n    return NextResponse.json({ success: true }, { status: 200 });\r\n  } catch (err: any) {\r\n    console.error(`Unexpected DELETE /api/books/${id} error`, err);\r\n    return NextResponse.json({ error: String(err) }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}